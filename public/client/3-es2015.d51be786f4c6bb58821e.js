(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"/5ox":function(e,t,a){"use strict";a.r(t),a.d(t,"CrupdateTitleModule",(function(){return ua}));var i=a("ofXK"),n=a("tyNb"),c=a("mrSG"),o=a("AcyG"),s=a("cIkh"),r=a("M/Pu"),l=a("2Vo4"),b=a("fXoL"),d=a("Rd8u"),p=a("FBzJ"),u=a("3Pt+"),m=a("h586"),g=a("Lm4C"),h=a("QeDF"),f=a("pLZG"),v=a("IzEk"),y=a("nYR2"),x=a("r2Ys"),W=a("kmQS"),X=a("7tLl"),S=a("i2dy"),C=a("l9qf"),E=a("bTqV"),w=a("Qu3c"),k=a("NFeN"),I=a("ihCf"),M=a("zW5C");function q(e,t){if(1&e&&(b.Xb(0,"option",42),b.Mc(1),b.Wb()),2&e){const e=t.$implicit;b.qc("ngValue",e),b.Eb(1),b.Nc(e)}}function D(e,t){if(1&e&&(b.Xb(0,"option",43),b.Mc(1),b.Wb()),2&e){const e=t.$implicit;b.qc("value",e.code),b.Eb(1),b.Nc(e.name)}}let O=(()=>{class e{constructor(e,t,a,i,n,c,o,s){this.store=e,this.fb=t,this.route=a,this.uploadQueue=i,this.settings=n,this.router=c,this.titles=o,this.toast=s,this.poster$=new l.a(null),this.form=this.fb.group({name:["",[u.I.required,u.I.minLength(1)]],is_series:[!1,[u.I.required]],language:[""],tagline:["",[u.I.minLength(1),u.I.maxLength(250)]],poster:["",[u.I.minLength(1),u.I.maxLength(250)]],backdrop:["",[u.I.minLength(1),u.I.maxLength(250)]],description:["",[u.I.minLength(1)]],budget:["",u.I.min(1)],revenue:["",u.I.min(1)],runtime:["",[u.I.min(1),u.I.max(300)]],country:["",[u.I.minLength(1),u.I.maxLength(50)]],popularity:[1,[u.I.min(1),u.I.max(100)]],certification:["pg"],release_date:[""],allow_update:[!0]}),this.certificationOptions=this.settings.getJson("browse.ageRatings")}ngOnInit(){this.store.dispatch(new s.q),this.store.select(r.a.title).pipe(Object(f.a)(e=>!!e.id),Object(v.a)(1)).subscribe(e=>{this.form.patchValue(Object.assign(Object.assign({},e),{release_date:e.release_date?e.release_date.split(" ")[0]:null})),this.poster$.next(e.poster)}),this.form.get("poster").valueChanges.subscribe(e=>{this.poster$.next(e)})}uploadImage(e){Object(g.a)({types:[h.a.image]}).then(t=>{this.uploadQueue.start(t,{uri:"uploads/images",httpParams:{diskPrefix:`media-images/${e}s`}}).subscribe(t=>{this.form.patchValue({[e]:t.fileEntry.url})})})}submit(){this.store.dispatch(new s.t(!0));const e=this.store.selectSnapshot(r.a.title).id;(e?this.titles.update(e,this.form.value):this.titles.create(this.form.value)).pipe(Object(y.a)(()=>this.store.dispatch(new s.t(!1)))).subscribe(()=>{this.toast.open(e?x.a.TITLE_UPDATE_SUCCESS:x.a.TITLE_CREATE_SUCCESS),this.router.navigate(e?[this.router.url.includes("admin")?"admin/titles":this.router.url.split("?")[0].replace("/edit","")]:["edit"])})}}return e.\u0275fac=function(t){return new(t||e)(b.Rb(o.g),b.Rb(u.h),b.Rb(n.a),b.Rb(m.a),b.Rb(W.a),b.Rb(n.d),b.Rb(X.a),b.Rb(S.b))},e.\u0275cmp=b.Lb({type:e,selectors:[["primary-facts-panel"]],features:[b.Db([m.a])],decls:88,vars:21,consts:[[3,"formGroup","ngSubmit"],[1,"poster-container"],[3,"src"],[1,"many-inputs"],[1,"input-container"],["for","name","trans",""],["type","text","formControlName","name","id","name","minlength","1","maxlength","250","required",""],[1,"inline-container"],["for","type","trans",""],["formControlName","is_series","id","type","required",""],["trans","",3,"ngValue"],["for","allow_update","trans",""],["formControlName","allow_update","id","allow_update","required",""],["for","poster","trans",""],[1,"input-with-action","action-left"],["type","button","mat-flat-button","","color","accent",3,"matTooltip","click"],["svgIcon","file-upload"],["type","text","formControlName","poster","id","poster","minlength","1","maxlength","250"],["for","backdrop","trans",""],["type","text","formControlName","backdrop","id","backdrop","minlength","1","maxlength","250"],["for","release_date","trans",""],["type","date","formControlName","release_date","id","release_date","required",""],["for","tagline","trans",""],["type","text","formControlName","tagline","id","tagline","minlength","1","maxlength","250"],["for","description","trans",""],["type","text","formControlName","description","id","description","minlength","1","cdkTextareaAutosize","","cdkAutosizeMinRows","6"],["for","runtime","trans",""],["type","number","formControlName","runtime","id","runtime","min","1","max","500"],[1,"input-container","certification-input-container"],["for","certification","trans",""],["formControlName","certification","id","certification"],[3,"ngValue",4,"ngFor","ngForOf"],["for","budget","trans",""],["type","number","formControlName","budget","id","budget","min","1"],["for","revenue","trans",""],["type","number","formControlName","revenue","id","revenue","min","1"],["for","popularity","trans",""],["type","number","formControlName","popularity","id","popularity","min","1","max","1000"],["for","language","trans",""],["formControlName","language","id","language","required",""],[3,"value",4,"ngFor","ngForOf"],["type","submit","mat-raised-button","","color","accent","trans","",3,"disabled"],[3,"ngValue"],[3,"value"]],template:function(e,t){1&e&&(b.Xb(0,"form",0),b.ec("ngSubmit",(function(){return t.submit()})),b.Xb(1,"div",1),b.Sb(2,"media-image",2),b.jc(3,"async"),b.Xb(4,"div",3),b.Xb(5,"div",4),b.Xb(6,"label",5),b.Mc(7,"Title"),b.Wb(),b.Sb(8,"input",6),b.Wb(),b.Xb(9,"div",7),b.Xb(10,"div",4),b.Xb(11,"label",8),b.Mc(12,"Type"),b.Wb(),b.Xb(13,"select",9),b.Xb(14,"option",10),b.Mc(15,"Movie"),b.Wb(),b.Xb(16,"option",10),b.Mc(17,"TV Series"),b.Wb(),b.Wb(),b.Wb(),b.Xb(18,"div",4),b.Xb(19,"label",11),b.Mc(20,"Allow Auto Update"),b.Wb(),b.Xb(21,"select",12),b.Xb(22,"option",10),b.Mc(23,"Yes"),b.Wb(),b.Xb(24,"option",10),b.Mc(25,"No"),b.Wb(),b.Wb(),b.Wb(),b.Wb(),b.Xb(26,"div",4),b.Xb(27,"label",13),b.Mc(28,"Poster"),b.Wb(),b.Xb(29,"div",14),b.Xb(30,"button",15),b.ec("click",(function(){return t.uploadImage("poster")})),b.jc(31,"trans"),b.Sb(32,"mat-icon",16),b.Wb(),b.Sb(33,"input",17),b.Wb(),b.Wb(),b.Xb(34,"div",4),b.Xb(35,"label",18),b.Mc(36,"Backdrop"),b.Wb(),b.Xb(37,"div",14),b.Xb(38,"button",15),b.ec("click",(function(){return t.uploadImage("backdrop")})),b.jc(39,"trans"),b.Sb(40,"mat-icon",16),b.Wb(),b.Sb(41,"input",19),b.Wb(),b.Wb(),b.Wb(),b.Wb(),b.Xb(42,"div",7),b.Xb(43,"div",4),b.Xb(44,"label",20),b.Mc(45,"Release Date"),b.Wb(),b.Sb(46,"input",21),b.Wb(),b.Xb(47,"div",4),b.Xb(48,"label",22),b.Mc(49,"Tagline"),b.Wb(),b.Sb(50,"input",23),b.Wb(),b.Wb(),b.Xb(51,"div",4),b.Xb(52,"label",24),b.Mc(53,"Overview"),b.Wb(),b.Sb(54,"textarea",25),b.Wb(),b.Xb(55,"div",7),b.Xb(56,"div",4),b.Xb(57,"label",26),b.Mc(58,"Runtime"),b.Wb(),b.Sb(59,"input",27),b.Wb(),b.Xb(60,"div",28),b.Xb(61,"label",29),b.Mc(62,"Certification"),b.Wb(),b.Xb(63,"select",30),b.Kc(64,q,2,2,"option",31),b.Wb(),b.Wb(),b.Wb(),b.Xb(65,"div",7),b.Xb(66,"div",4),b.Xb(67,"label",32),b.Mc(68,"Budget"),b.Wb(),b.Sb(69,"input",33),b.Wb(),b.Xb(70,"div",4),b.Xb(71,"label",34),b.Mc(72,"Revenue"),b.Wb(),b.Sb(73,"input",35),b.Wb(),b.Wb(),b.Xb(74,"div",7),b.Xb(75,"div",4),b.Xb(76,"label",36),b.Mc(77,"Popularity"),b.Wb(),b.Sb(78,"input",37),b.Wb(),b.Xb(79,"div",4),b.Xb(80,"label",38),b.Mc(81,"Language"),b.Wb(),b.Xb(82,"select",39),b.Kc(83,D,2,2,"option",40),b.jc(84,"async"),b.Wb(),b.Wb(),b.Wb(),b.Xb(85,"button",41),b.jc(86,"async"),b.Mc(87,"Save"),b.Wb(),b.Wb()),2&e&&(b.qc("formGroup",t.form),b.Eb(2),b.qc("src",b.kc(3,11,t.poster$)),b.Eb(12),b.qc("ngValue",!1),b.Eb(2),b.qc("ngValue",!0),b.Eb(6),b.qc("ngValue",!0),b.Eb(2),b.qc("ngValue",!1),b.Eb(6),b.qc("matTooltip",b.kc(31,13,"Upload poster")),b.Eb(8),b.qc("matTooltip",b.kc(39,15,"Upload backdrop")),b.Eb(26),b.qc("ngForOf",t.certificationOptions),b.Eb(19),b.qc("ngForOf",b.kc(84,17,t.languageOptions$)),b.Eb(2),b.qc("disabled",b.kc(86,19,t.loading$)))},directives:[u.K,u.v,u.m,C.a,d.a,u.d,u.u,u.k,u.q,u.p,u.F,u.G,u.z,u.J,E.b,w.a,k.a,I.b,u.A,i.s],pipes:[i.b,M.a],styles:["primary-facts-panel{display:block}primary-facts-panel .poster-container{display:flex;margin-bottom:20px}primary-facts-panel .poster-container media-image img{height:350px;width:auto;box-shadow:0 2px 1px -1px rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 1px 3px 0 rgba(0,0,0,.12);border-radius:4px}primary-facts-panel .poster-container .many-inputs{margin-left:20px;flex:1 1 auto}primary-facts-panel .poster-container .many-inputs .input-container:last-of-type{margin-bottom:0}primary-facts-panel .certification-input-container option,primary-facts-panel .certification-input-container select{text-transform:uppercase}"],encapsulation:2,changeDetection:0}),Object(c.b)([Object(o.d)(r.a.title)],e.prototype,"title$",void 0),Object(c.b)([Object(o.d)(r.a.loading)],e.prototype,"loading$",void 0),Object(c.b)([Object(o.d)(r.a.languageOptions)],e.prototype,"languageOptions$",void 0),e})();var R=a("/RwR"),T=a("QGXG"),P=a("7EHt"),j=a("wZkO"),$=a("0IaG"),K=a("Sx+n"),_=a("JX91"),N=a("lJxs"),L=a("0Ej5"),V=a("VaGr"),F=a("/1cH"),A=a("FKr1");function U(e,t){1&e&&(b.Xb(0,"h2",11),b.Mc(1,"Edit"),b.Wb())}function B(e,t){1&e&&(b.Xb(0,"h2",11),b.Mc(1,"Create"),b.Wb())}function z(e,t){if(1&e&&(b.Xb(0,"div",12),b.Xb(1,"label",13),b.Mc(2,"Person"),b.Wb(),b.Sb(3,"input",14),b.Wb()),2&e){const e=b.ic();b.Eb(3),b.qc("value",null==e.credit?null:e.credit.name)}}function H(e,t){if(1&e){const e=b.Yb();b.Xb(0,"search-input",15),b.ec("resultSelected",(function(t){return b.Bc(e),b.ic().setCredit(t)})),b.Wb()}if(2&e){const e=b.ic();b.qc("type",e.getPersonType())("resetInputOnSelect",!1)}}function G(e,t){1&e&&(b.Xb(0,"div",12),b.Xb(1,"label",16),b.Mc(2,"Character"),b.Wb(),b.Sb(3,"input",17),b.Wb())}function J(e,t){if(1&e&&(b.Xb(0,"mat-option",25),b.Xb(1,"div",26),b.Xb(2,"span",27),b.Mc(3,"Job"),b.Wb(),b.Mc(4),b.Wb(),b.Xb(5,"div",28),b.Xb(6,"span",27),b.Mc(7,"Department"),b.Wb(),b.Mc(8),b.Wb(),b.Wb()),2&e){const e=t.$implicit;b.qc("value",e.job),b.Eb(4),b.Oc(": ",e.job,""),b.Eb(4),b.Oc(": ",e.department,"")}}function Y(e,t){if(1&e){const e=b.Yb();b.Vb(0),b.Xb(1,"div",12),b.Xb(2,"label",18),b.Mc(3,"Job"),b.Wb(),b.Sb(4,"input",19),b.Wb(),b.Xb(5,"mat-autocomplete",20,21),b.ec("optionSelected",(function(t){return b.Bc(e),b.ic().jobSelected(t)})),b.Kc(7,J,9,3,"mat-option",22),b.jc(8,"async"),b.Wb(),b.Xb(9,"div",12),b.Xb(10,"label",23),b.Mc(11,"Department"),b.Wb(),b.Sb(12,"input",24),b.Wb(),b.Ub()}if(2&e){const e=b.yc(6),t=b.ic();b.Eb(4),b.qc("matAutocomplete",e),b.Eb(3),b.qc("ngForOf",b.kc(8,2,t.filteredJobs))}}let Q=(()=>{class e{constructor(e,t,a,i,n,c,o){this.store=e,this.toast=t,this.fb=a,this.actions$=i,this.dialogRef=n,this.valueLists=c,this.data=o,this.form=this.fb.group({character:[""],department:[""],job:[""]}),this.availableJobs=[],this.data.credit&&(this.credit=this.data.credit,this.form.patchValue(this.data.credit.pivot))}ngOnInit(){this.valueLists.get(["tmdbJobs"]).subscribe(e=>{this.availableJobs=[],e.tmdbJobs.forEach(e=>{const t=e.jobs.map(t=>({job:t,department:e.department}));this.availableJobs=[...this.availableJobs,...t]}),this.filteredJobs=this.form.get("job").valueChanges.pipe(Object(_.a)(""),Object(N.a)(e=>this.availableJobs.filter(t=>!(e=e.toLowerCase())||t.job.toLowerCase().includes(e)||t.department.toLowerCase().includes(e)).slice(0,10)))})}confirm(){var e;const t=this.data.credit?new s.u(this.credit.pivot.id,this.getPayload()):new s.a(null===(e=this.credit)||void 0===e?void 0:e.id,this.data.mediaItem,this.getPayload());this.store.dispatch(t).subscribe(()=>{this.close(),this.toast.open(this.data.credit?x.a.CREDIT_UPDATE_SUCCESS:x.a.CREDIT_ADD_SUCCESS)},e=>{this.toast.open(e.message)})}close(){this.dialogRef.close()}setCredit(e){this.credit=e}getPayload(){const e=this.form.value;return"cast"===this.data.type&&(e.department="cast",e.job="cast"),e}getPersonType(){return K.a.PERSON}jobSelected(e){const t=this.availableJobs.find(t=>t.job===e.option.value);this.form.patchValue({job:t.job,department:t.department})}}return e.\u0275fac=function(t){return new(t||e)(b.Rb(o.g),b.Rb(S.b),b.Rb(u.h),b.Rb(o.b),b.Rb($.h),b.Rb(L.a),b.Rb($.a))},e.\u0275cmp=b.Lb({type:e,selectors:[["crupdate-credit-modal"]],decls:17,vars:10,consts:[[1,"modal-header"],["class","modal-title","mat-dialog-title","","trans","",4,"ngIf"],["type","button",1,"close-button","no-style","icon-button",3,"click"],["svgIcon","close"],["autocomplete","off","ngNativeValidate","",3,"formGroup","ngSubmit"],[1,"many-inputs"],["class","input-container",4,"ngIf"],["placeholder","Search for a person...","label","Person","searchProvider","local",3,"type","resetInputOnSelect","resultSelected",4,"ngIf"],[4,"ngIf"],["type","button","mat-button","","trans","",3,"click"],["type","submit","mat-raised-button","","color","accent","trans","",3,"disabled"],["mat-dialog-title","","trans","",1,"modal-title"],[1,"input-container"],["for","name","trans",""],["type","text","id","name","disabled","",3,"value"],["placeholder","Search for a person...","label","Person","searchProvider","local",3,"type","resetInputOnSelect","resultSelected"],["for","character","trans",""],["type","text","id","character","formControlName","character","required",""],["for","job","trans",""],["type","text","id","job","formControlName","job","required","",3,"matAutocomplete"],[3,"optionSelected"],["auto","matAutocomplete"],["class","multiline-mat-menu-item",3,"value",4,"ngFor","ngForOf"],["for","department","trans",""],["type","text","id","department","formControlName","department","required",""],[1,"multiline-mat-menu-item",3,"value"],[1,"title"],["trans",""],[1,"description"]],template:function(e,t){1&e&&(b.Xb(0,"div",0),b.Kc(1,U,2,0,"h2",1),b.Kc(2,B,2,0,"h2",1),b.Xb(3,"button",2),b.ec("click",(function(){return t.close()})),b.Sb(4,"mat-icon",3),b.Wb(),b.Wb(),b.Xb(5,"form",4),b.ec("ngSubmit",(function(){return t.confirm()})),b.Xb(6,"mat-dialog-content",5),b.Kc(7,z,4,1,"div",6),b.Kc(8,H,1,2,"search-input",7),b.Kc(9,G,4,0,"div",6),b.Kc(10,Y,13,4,"ng-container",8),b.Wb(),b.Xb(11,"mat-dialog-actions"),b.Xb(12,"button",9),b.ec("click",(function(){return t.close()})),b.Mc(13,"Cancel"),b.Wb(),b.Xb(14,"button",10),b.jc(15,"async"),b.Mc(16,"Save"),b.Wb(),b.Wb(),b.Wb()),2&e&&(b.Eb(1),b.qc("ngIf",t.data.credit),b.Eb(1),b.qc("ngIf",!t.data.credit),b.Eb(3),b.qc("formGroup",t.form),b.Eb(2),b.qc("ngIf",t.data.credit),b.Eb(1),b.qc("ngIf",!t.data.credit),b.Eb(1),b.qc("ngIf","cast"===t.data.type),b.Eb(1),b.qc("ngIf","crew"===t.data.type),b.Eb(4),b.qc("disabled",b.kc(15,8,t.loading$)))},directives:[i.t,k.a,u.v,u.m,$.f,$.c,E.b,d.a,$.i,V.a,u.d,u.u,u.k,u.F,F.c,F.a,i.s,A.n],pipes:[i.b],styles:["crupdate-credit-modal{display:block;width:400px;max-width:100%}crupdate-credit-modal search-input input{border-color:var(--be-divider-default);margin-bottom:20px}"],encapsulation:2,changeDetection:0}),Object(c.b)([Object(o.d)(r.a.loading)],e.prototype,"loading$",void 0),e})();var Z=a("Dh3D"),ee=a("+0xr"),te=a("5+WD"),ae=a("CH4Q");function ie(e,t){1&e&&(b.Xb(0,"mat-header-cell",16),b.Mc(1,"Person"),b.Wb())}function ne(e,t){1&e&&(b.Xb(0,"button",19),b.Sb(1,"mat-icon",20),b.Wb())}function ce(e,t){if(1&e&&(b.Xb(0,"mat-cell"),b.Kc(1,ne,2,0,"button",17),b.Sb(2,"media-image",18),b.Xb(3,"span"),b.Mc(4),b.Wb(),b.Wb()),2&e){const e=t.$implicit,a=b.ic();b.Eb(1),b.qc("ngIf","cast"===a.type),b.Eb(1),b.qc("src",e.poster),b.Eb(2),b.Nc(e.name)}}function oe(e,t){1&e&&(b.Xb(0,"mat-header-cell",16),b.Mc(1,"Character"),b.Wb())}function se(e,t){if(1&e&&(b.Xb(0,"mat-cell"),b.Mc(1),b.Wb()),2&e){const e=t.$implicit;b.Eb(1),b.Oc(" ",e.pivot.character," ")}}function re(e,t){1&e&&(b.Vb(0,21),b.Kc(1,oe,2,0,"mat-header-cell",8),b.Kc(2,se,2,1,"mat-cell",9),b.Ub())}function le(e,t){1&e&&(b.Xb(0,"mat-header-cell",16),b.Mc(1,"Department"),b.Wb())}function be(e,t){if(1&e&&(b.Xb(0,"mat-cell"),b.Mc(1),b.Wb()),2&e){const e=t.$implicit;b.Eb(1),b.Oc(" ",e.pivot.department," ")}}function de(e,t){1&e&&(b.Xb(0,"mat-header-cell",16),b.Mc(1,"Job"),b.Wb())}function pe(e,t){if(1&e&&(b.Xb(0,"mat-cell"),b.Mc(1),b.Wb()),2&e){const e=t.$implicit;b.Eb(1),b.Oc(" ",e.pivot.job," ")}}function ue(e,t){1&e&&(b.Vb(0),b.Vb(1,22),b.Kc(2,le,2,0,"mat-header-cell",8),b.Kc(3,be,2,1,"mat-cell",9),b.Ub(),b.Vb(4,23),b.Kc(5,de,2,0,"mat-header-cell",8),b.Kc(6,pe,2,1,"mat-cell",9),b.Ub(),b.Ub())}function me(e,t){1&e&&b.Sb(0,"mat-header-cell")}function ge(e,t){if(1&e){const e=b.Yb();b.Xb(0,"mat-cell"),b.Xb(1,"button",24),b.ec("click",(function(){b.Bc(e);const a=t.$implicit;return b.ic().openCrupdateCreditModal(a)})),b.Sb(2,"mat-icon",25),b.Wb(),b.Xb(3,"button",24),b.ec("click",(function(){b.Bc(e);const a=t.$implicit;return b.ic().detachCredit(a)})),b.Sb(4,"mat-icon",26),b.Wb(),b.Wb()}}function he(e,t){1&e&&b.Sb(0,"mat-header-row")}function fe(e,t){1&e&&b.Sb(0,"span")}function ve(e,t){1&e&&(b.Xb(0,"mat-row",27),b.Kc(1,fe,1,0,"span",28),b.Wb())}function ye(e,t){1&e&&(b.Xb(0,"no-results-message"),b.Xb(1,"span",29),b.Mc(2,"Nothing to Display."),b.Wb(),b.Xb(3,"span",30),b.Mc(4,"There are no credits attached yet."),b.Wb(),b.Wb())}let xe=(()=>{class e{constructor(e,t,a){this.dialog=e,this.store=t,this.toast=a,this.castColumns=["person","character","edit"],this.crewColumns=["person","department","job","edit"],this.dataSource=new ee.p}ngOnInit(){this.dataSource.sort=this.matSort,this.dataSource.sortingDataAccessor=(e,t)=>{switch(t){case"person":return e.name;default:return e.pivot[t]}}}ngOnChanges(e){e.mediaItem&&e.mediaItem.currentValue&&(this.dataSource.data="cast"===this.type?this.getCast(this.mediaItem.credits):this.getCrew(this.mediaItem.credits))}openCrupdateCreditModal(e){this.dialog.open(Q,{credit:e,type:this.type,mediaItem:this.mediaItem})}detachCredit(e){this.dialog.open(R.a,{title:"Remove Credit",body:"Are you sure you want to remove this credit?",ok:"Remove"}).afterClosed().subscribe(t=>{t&&this.store.dispatch(new s.r(this.mediaItem,e)).subscribe(()=>{this.toast.open(x.a.CREDIT_REMOVE_SUCCESS)})})}changeCreditsOrder(e){this.store.selectSnapshot(r.a.loading)||this.store.dispatch(new s.e(this.mediaItem,e.previousIndex,e.currentIndex,this.type))}applyFilter(e){this.dataSource.filter=e}getCast(e){return e?e.filter(e=>"cast"===e.pivot.department):[]}getCrew(e){return e?e.filter(e=>"cast"!==e.pivot.department):[]}}return e.\u0275fac=function(t){return new(t||e)(b.Rb(T.a),b.Rb(o.g),b.Rb(S.b))},e.\u0275cmp=b.Lb({type:e,selectors:[["credits-panel"]],viewQuery:function(e,t){var a;1&e&&b.Ic(Z.a,!0),2&e&&b.xc(a=b.fc())&&(t.matSort=a.first)},inputs:{mediaItem:"mediaItem",type:"type"},features:[b.Cb],decls:19,vars:6,consts:[[1,"table-header"],[1,"button-container"],["type","button","mat-raised-button","","color","accent","trans","",3,"click"],[1,"input-container"],["type","text","placeholder","Search...","trans-placeholder","",3,"keyup"],["svgIcon","search"],["matSort","","cdkDropList","",3,"dataSource","cdkDropListDropped"],["matColumnDef","person"],["mat-sort-header","","trans","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","character",4,"ngIf"],[4,"ngIf"],["matColumnDef","edit"],[4,"matHeaderCellDef"],[4,"matHeaderRowDef"],["cdkDrag","",4,"matRowDef","matRowDefColumns"],["mat-sort-header","","trans",""],["type","button","mat-icon-button","","cdkDragHandle","",4,"ngIf"],["size","small",3,"src"],["type","button","mat-icon-button","","cdkDragHandle",""],["svgIcon","drag-handle"],["matColumnDef","character"],["matColumnDef","department"],["matColumnDef","job"],["type","button","mat-icon-button","",3,"click"],["svgIcon","edit"],["svgIcon","close"],["cdkDrag",""],[4,"cdkDragPreview"],["primary-text","","trans",""],["secondary-text","","trans",""]],template:function(e,t){1&e&&(b.Xb(0,"div",0),b.Xb(1,"div",1),b.Xb(2,"button",2),b.ec("click",(function(){return t.openCrupdateCreditModal()})),b.Mc(3,"Add Credit"),b.Wb(),b.Wb(),b.Xb(4,"div",3),b.Xb(5,"input",4),b.ec("keyup",(function(e){return t.applyFilter(e.target.value)})),b.Wb(),b.Sb(6,"mat-icon",5),b.Wb(),b.Wb(),b.Xb(7,"mat-table",6),b.ec("cdkDropListDropped",(function(e){return t.changeCreditsOrder(e)})),b.Vb(8,7),b.Kc(9,ie,2,0,"mat-header-cell",8),b.Kc(10,ce,5,3,"mat-cell",9),b.Ub(),b.Kc(11,re,3,0,"ng-container",10),b.Kc(12,ue,7,0,"ng-container",11),b.Vb(13,12),b.Kc(14,me,1,0,"mat-header-cell",13),b.Kc(15,ge,5,0,"mat-cell",9),b.Ub(),b.Kc(16,he,1,0,"mat-header-row",14),b.Kc(17,ve,2,0,"mat-row",15),b.Wb(),b.Kc(18,ye,5,0,"no-results-message",11)),2&e&&(b.Eb(7),b.qc("dataSource",t.dataSource),b.Eb(4),b.qc("ngIf","cast"===t.type),b.Eb(1),b.qc("ngIf","crew"===t.type),b.Eb(4),b.qc("matHeaderRowDef","cast"===t.type?t.castColumns:t.crewColumns),b.Eb(1),b.qc("matRowDefColumns","cast"===t.type?t.castColumns:t.crewColumns),b.Eb(1),b.qc("ngIf",!t.dataSource.data.length))},directives:[E.b,d.a,k.a,ee.o,Z.a,te.d,ee.c,ee.i,ee.b,i.t,ee.k,ee.n,ee.h,Z.b,ee.a,C.a,te.b,ee.j,ee.m,te.a,te.c,ae.a],styles:["credits-panel{display:block}credits-panel .cdk-drag-handle{cursor:move;margin-right:10px}credits-panel media-image{margin-right:15px}credits-panel media-image img{width:35px;height:35px;border-radius:4px}credits-panel .cdk-drag-placeholder{background-color:var(--be-hover)}credits-panel .cdk-drag-animating,credits-panel .cdk-drop-list-dragging .mat-row:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"],encapsulation:2,changeDetection:0}),e})();function We(e,t){1&e&&(b.Xb(0,"h2",30),b.Mc(1,"Edit Episode"),b.Wb())}function Xe(e,t){1&e&&(b.Xb(0,"h2",30),b.Mc(1,"Create Episode"),b.Wb())}function Se(e,t){if(1&e&&(b.Xb(0,"div",31),b.Mc(1),b.Wb()),2&e){const e=t.ngIf;b.Eb(1),b.Nc(e)}}let Ce=(()=>{class e{constructor(e,t,a,i,n,c){this.store=e,this.toast=t,this.fb=a,this.uploadQueue=i,this.dialogRef=n,this.data=c,this.episode$=new l.a(null),this.errors$=new l.a({}),this.episodeForm=this.fb.group({name:["",[u.I.required,u.I.minLength(1)]],poster:["",[u.I.minLength(1),u.I.maxLength(250)]],description:["",[u.I.minLength(1)]],popularity:[50,[u.I.min(1),u.I.max(1e3)]],release_date:[""],episode_number:[""]})}ngOnInit(){this.data.episode?(this.bindToStoreEpisode(),this.episodeForm.patchValue(Object.assign(Object.assign({},this.episode$.value),{release_date:this.episode$.value.release_date.split(" ")[0]})),setTimeout(()=>this.loadEpisodeCredits())):this.episodeForm.patchValue({episode_number:this.data.season?this.data.season.episode_count+1:1})}confirm(){this.data.episode?this.updateEpisode():this.createEpisode()}close(){this.dialogRef.close()}createEpisode(){this.store.dispatch(new s.h(this.data.season,this.episodeForm.value)).subscribe(()=>{this.errors$.next({}),this.toast.open(x.a.EPISODE_CREATE_SUCCESS);const e=this.store.selectSnapshot(r.a.seasons).find(e=>e.id===this.data.season.id).episodes;this.data.episode=e[e.length-1]},e=>this.errors$.next(e.errors))}updateEpisode(){this.store.dispatch(new s.v(this.data.episode,this.episodeForm.value)).subscribe(()=>{this.errors$.next({}),this.toast.open(x.a.EPISODE_UPDATE_SUCCESS),this.close()},e=>this.errors$.next(e.errors))}uploadPoster(){Object(g.a)({types:[h.a.image]}).then(e=>{this.uploadQueue.start(e,{uri:"uploads/images",httpParams:{diskPrefix:"media-images/posters"}}).subscribe(e=>{this.episodeForm.patchValue({poster:e.fileEntry.url})})})}bindToStoreEpisode(){this.store.select(r.a.title).subscribe(e=>{if(e.seasons){const t=e.seasons.find(e=>e.number===this.data.episode.season_number).episodes.find(e=>e.episode_number===this.data.episode.episode_number);this.episode$.next(Object.assign({},t))}})}loadEpisodeCredits(){this.data.episode.credits||this.store.dispatch(new s.p(this.episode$.value)).toPromise()}}return e.\u0275fac=function(t){return new(t||e)(b.Rb(o.g),b.Rb(S.b),b.Rb(u.h),b.Rb(m.a),b.Rb($.h),b.Rb($.a))},e.\u0275cmp=b.Lb({type:e,selectors:[["crupdate-episode-modal"]],features:[b.Db([m.a])],decls:55,vars:30,consts:[[1,"modal-header"],["class","modal-title","mat-dialog-title","","trans","",4,"ngIf"],["type","button",1,"close-button","no-style","icon-button",3,"click"],["svgIcon","close"],["autocomplete","off","ngNativeValidate","",3,"formGroup","ngSubmit"],["animationDuration","0ms","color","accent",3,"dynamicHeight"],[3,"label"],[1,"many-inputs","primary-facts-panel"],[1,"input-container"],["for","name","trans",""],["type","text","formControlName","name","id","name","minlength","1","maxlength","250","required",""],["for","episode_number","trans",""],["type","number","formControlName","episode_number","id","episode_number","min","1","required",""],["class","error",4,"ngIf"],["for","poster","trans",""],[1,"input-with-action","action-left"],["type","button","mat-flat-button","","color","accent",3,"matTooltip","click"],["svgIcon","file-upload"],["type","text","formControlName","poster","id","poster","minlength","1","maxlength","250"],["for","release_date","trans",""],["type","date","formControlName","release_date","id","release_date","required",""],["for","description","trans",""],["type","text","formControlName","description","id","description","minlength","1","cdkTextareaAutosize","","cdkAutosizeMinRows","6"],["for","popularity","trans",""],["type","number","formControlName","popularity","id","popularity","min","1","max","1000"],[3,"label","disabled"],["type","cast",3,"mediaItem"],["type","crew",3,"mediaItem"],["type","button","mat-button","","trans","",3,"click"],["type","submit","mat-raised-button","","color","accent","trans","",3,"disabled"],["mat-dialog-title","","trans","",1,"modal-title"],[1,"error"]],template:function(e,t){1&e&&(b.Xb(0,"div",0),b.Kc(1,We,2,0,"h2",1),b.Kc(2,Xe,2,0,"h2",1),b.Xb(3,"button",2),b.ec("click",(function(){return t.close()})),b.Sb(4,"mat-icon",3),b.Wb(),b.Wb(),b.Xb(5,"form",4),b.ec("ngSubmit",(function(){return t.confirm()})),b.Xb(6,"mat-dialog-content"),b.Xb(7,"mat-tab-group",5),b.Xb(8,"mat-tab",6),b.jc(9,"trans"),b.Xb(10,"div",7),b.Xb(11,"div",8),b.Xb(12,"label",9),b.Mc(13,"Title"),b.Wb(),b.Sb(14,"input",10),b.Wb(),b.Xb(15,"div",8),b.Xb(16,"label",11),b.Mc(17,"Number"),b.Wb(),b.Sb(18,"input",12),b.Kc(19,Se,2,1,"div",13),b.jc(20,"async"),b.Wb(),b.Xb(21,"div",8),b.Xb(22,"label",14),b.Mc(23,"Poster"),b.Wb(),b.Xb(24,"div",15),b.Xb(25,"button",16),b.ec("click",(function(){return t.uploadPoster()})),b.jc(26,"trans"),b.Sb(27,"mat-icon",17),b.Wb(),b.Sb(28,"input",18),b.Wb(),b.Wb(),b.Xb(29,"div",8),b.Xb(30,"label",19),b.Mc(31,"Release Date"),b.Wb(),b.Sb(32,"input",20),b.Wb(),b.Xb(33,"div",8),b.Xb(34,"label",21),b.Mc(35,"Overview"),b.Wb(),b.Sb(36,"textarea",22),b.Wb(),b.Xb(37,"div",8),b.Xb(38,"label",23),b.Mc(39,"Popularity"),b.Wb(),b.Sb(40,"input",24),b.Wb(),b.Wb(),b.Wb(),b.Xb(41,"mat-tab",25),b.jc(42,"trans"),b.Sb(43,"credits-panel",26),b.jc(44,"async"),b.Wb(),b.Xb(45,"mat-tab",25),b.jc(46,"trans"),b.Sb(47,"credits-panel",27),b.jc(48,"async"),b.Wb(),b.Wb(),b.Wb(),b.Xb(49,"mat-dialog-actions"),b.Xb(50,"button",28),b.ec("click",(function(){return t.close()})),b.Mc(51,"Cancel"),b.Wb(),b.Xb(52,"button",29),b.jc(53,"async"),b.Mc(54,"Save"),b.Wb(),b.Wb(),b.Wb()),2&e&&(b.Eb(1),b.qc("ngIf",t.data.episode),b.Eb(1),b.qc("ngIf",!t.data.episode),b.Eb(3),b.qc("formGroup",t.episodeForm),b.Eb(2),b.qc("dynamicHeight",!0),b.Eb(1),b.qc("label",b.kc(9,14,"Primary Facts")),b.Eb(11),b.qc("ngIf",b.kc(20,16,t.errors$).episode_number),b.Eb(6),b.qc("matTooltip",b.kc(26,18,"Upload poster")),b.Eb(16),b.qc("label",b.kc(42,20,"Cast"))("disabled",!t.data.episode),b.Eb(2),b.qc("mediaItem",b.kc(44,22,t.episode$)),b.Eb(2),b.qc("label",b.kc(46,24,"Crew"))("disabled",!t.data.episode),b.Eb(2),b.qc("mediaItem",b.kc(48,26,t.episode$)),b.Eb(5),b.qc("disabled",b.kc(53,28,t.loading$)))},directives:[i.t,k.a,u.v,u.m,$.f,j.c,j.a,d.a,u.d,u.u,u.k,u.q,u.p,u.F,u.A,E.b,w.a,I.b,xe,$.c,$.i],pipes:[M.a,i.b],styles:["[_nghost-%COMP%]{display:block;width:750px;max-width:100%}label[_ngcontent-%COMP%]{text-transform:capitalize}.primary-facts-panel[_ngcontent-%COMP%], credits-panel[_ngcontent-%COMP%]{padding:20px 0}"],changeDetection:0}),Object(c.b)([Object(o.d)(r.a.loading)],e.prototype,"loading$",void 0),e})();var Ee=a("iB19");function we(e,t){1&e&&(b.Xb(0,"mat-header-cell",17),b.Mc(1,"Name"),b.Wb())}function ke(e,t){if(1&e&&(b.Xb(0,"mat-cell"),b.Sb(1,"media-image",18),b.Xb(2,"span"),b.Mc(3),b.Wb(),b.Wb()),2&e){const e=t.$implicit;b.Eb(1),b.qc("src",e.poster)("alt",e.name),b.Eb(2),b.Nc(e.name)}}function Ie(e,t){1&e&&(b.Xb(0,"mat-header-cell",17),b.Mc(1,"Number"),b.Wb())}function Me(e,t){if(1&e&&(b.Xb(0,"mat-cell"),b.Mc(1),b.Wb()),2&e){const e=t.$implicit;b.Eb(1),b.Oc(" ",e.episode_number," ")}}function qe(e,t){1&e&&(b.Xb(0,"mat-header-cell",17),b.Mc(1,"Release Date"),b.Wb())}function De(e,t){if(1&e&&(b.Xb(0,"mat-cell"),b.Mc(1),b.jc(2,"formattedDate"),b.Wb()),2&e){const e=t.$implicit;b.Eb(1),b.Oc(" ",b.kc(2,1,e.release_date)," ")}}function Oe(e,t){1&e&&b.Sb(0,"mat-header-cell")}function Re(e,t){if(1&e){const e=b.Yb();b.Xb(0,"mat-cell"),b.Xb(1,"button",19),b.ec("click",(function(){b.Bc(e);const a=t.$implicit;return b.ic().openCrupdateEpisodeModal(a)})),b.Sb(2,"mat-icon",20),b.Wb(),b.Xb(3,"button",19),b.ec("click",(function(){b.Bc(e);const a=t.$implicit;return b.ic().deleteEpisode(a)})),b.Sb(4,"mat-icon",21),b.Wb(),b.Wb()}}function Te(e,t){1&e&&b.Sb(0,"mat-header-row")}function Pe(e,t){1&e&&b.Sb(0,"mat-row")}function je(e,t){1&e&&(b.Xb(0,"no-results-message"),b.Xb(1,"span",22),b.Mc(2,"Nothing to Display."),b.Wb(),b.Xb(3,"span",23),b.Mc(4,"This season does not have any episodes yet."),b.Wb(),b.Wb())}const $e=function(){return["name","number","release-date","edit"]};let Ke=(()=>{class e{constructor(e,t,a,i){this.store=e,this.dialog=t,this.toast=a,this.route=i,this.dataSource=new ee.p([]),this.trackByFn=(e,t)=>t.id}ngOnInit(){this.dataSource.sort=this.matSort}ngAfterViewInit(){const e=+this.route.snapshot.params.episodeNumber;if(e){const t=this.season.episodes.find(t=>t.episode_number===e);t&&this.openCrupdateEpisodeModal(t)}}ngOnChanges(e){e.season.currentValue&&e.season.currentValue.episodes&&(this.dataSource.data=this.season.episodes)}deleteEpisode(e){this.dialog.open(R.a,{title:"Delete Episode",body:"Are you sure you want to delete this episode?",ok:"Delete"}).afterClosed().subscribe(t=>{t&&this.store.dispatch(new s.j(e)).subscribe(()=>{this.toast.open(x.a.EPISODE_DELETE_SUCCESS)})})}openCrupdateEpisodeModal(e){this.dialog.open(Ce,{episode:e,season:this.season},{panelClass:"crupdate-episode-modal-container"})}applyFilter(e){this.dataSource.filter=e}}return e.\u0275fac=function(t){return new(t||e)(b.Rb(o.g),b.Rb(T.a),b.Rb(S.b),b.Rb(n.a))},e.\u0275cmp=b.Lb({type:e,selectors:[["episodes-panel"]],viewQuery:function(e,t){var a;1&e&&b.Ic(Z.a,!0),2&e&&b.xc(a=b.fc())&&(t.matSort=a.first)},inputs:{season:"season"},features:[b.Cb],decls:23,vars:7,consts:[[1,"table-header"],[1,"button-container"],["mat-raised-button","","color","accent","trans","",3,"click"],[1,"input-container"],["type","text","placeholder","Search...","trans-placeholder","",3,"keyup"],["svgIcon","search"],[3,"dataSource","trackBy"],["matColumnDef","name"],["trans","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","number"],["matColumnDef","release-date"],["matColumnDef","edit"],[4,"matHeaderCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[4,"ngIf"],["trans",""],["size","small",3,"src","alt"],["type","button","mat-icon-button","",3,"click"],["svgIcon","edit"],["svgIcon","close"],["primary-text","","trans",""],["secondary-text","","trans",""]],template:function(e,t){1&e&&(b.Xb(0,"div",0),b.Xb(1,"div",1),b.Xb(2,"button",2),b.ec("click",(function(){return t.openCrupdateEpisodeModal()})),b.Mc(3,"Add Episode"),b.Wb(),b.Wb(),b.Xb(4,"div",3),b.Xb(5,"input",4),b.ec("keyup",(function(e){return t.applyFilter(e.target.value)})),b.Wb(),b.Sb(6,"mat-icon",5),b.Wb(),b.Wb(),b.Xb(7,"mat-table",6),b.Vb(8,7),b.Kc(9,we,2,0,"mat-header-cell",8),b.Kc(10,ke,4,3,"mat-cell",9),b.Ub(),b.Vb(11,10),b.Kc(12,Ie,2,0,"mat-header-cell",8),b.Kc(13,Me,2,1,"mat-cell",9),b.Ub(),b.Vb(14,11),b.Kc(15,qe,2,0,"mat-header-cell",8),b.Kc(16,De,3,3,"mat-cell",9),b.Ub(),b.Vb(17,12),b.Kc(18,Oe,1,0,"mat-header-cell",13),b.Kc(19,Re,5,0,"mat-cell",9),b.Ub(),b.Kc(20,Te,1,0,"mat-header-row",14),b.Kc(21,Pe,1,0,"mat-row",15),b.Wb(),b.Kc(22,je,5,0,"no-results-message",16)),2&e&&(b.Eb(7),b.qc("dataSource",t.dataSource)("trackBy",t.trackByFn),b.Eb(13),b.qc("matHeaderRowDef",b.tc(5,$e)),b.Eb(1),b.qc("matRowDefColumns",b.tc(6,$e)),b.Eb(1),b.qc("ngIf",!t.dataSource.data.length))},directives:[E.b,d.a,k.a,ee.o,ee.c,ee.i,ee.b,ee.k,ee.n,i.t,ee.h,ee.a,C.a,ee.j,ee.m,ae.a],pipes:[Ee.a],styles:["episodes-panel{display:block}episodes-panel .table-header{display:flex;align-items:center;margin-bottom:15px}episodes-panel .table-header .input-container{max-width:300px;margin-left:auto;position:relative}episodes-panel .table-header .input-container .mat-icon{position:absolute;top:11px;right:8px}episodes-panel no-results-message{margin-top:50px}"],encapsulation:2,changeDetection:0}),e})();function _e(e,t){if(1&e&&(b.Xb(0,"mat-tab-group",8),b.Xb(1,"mat-tab",9),b.jc(2,"trans"),b.Sb(3,"episodes-panel",10),b.Wb(),b.Xb(4,"mat-tab",9),b.jc(5,"trans"),b.Sb(6,"credits-panel",11),b.Wb(),b.Xb(7,"mat-tab",9),b.jc(8,"trans"),b.Sb(9,"credits-panel",12),b.Wb(),b.Wb()),2&e){const e=b.ic().$implicit;b.Eb(1),b.qc("label",b.kc(2,6,"Episodes")),b.Eb(2),b.qc("season",e),b.Eb(1),b.qc("label",b.kc(5,8,"Regular Cast")),b.Eb(2),b.qc("mediaItem",e),b.Eb(1),b.qc("label",b.kc(8,10,"Regular Crew")),b.Eb(2),b.qc("mediaItem",e)}}function Ne(e,t){if(1&e){const e=b.Yb();b.Xb(0,"mat-expansion-panel",4),b.jc(1,"async"),b.Xb(2,"mat-expansion-panel-header"),b.Xb(3,"mat-panel-title"),b.Xb(4,"span",5),b.Mc(5,"Season"),b.Wb(),b.Mc(6," \xa0 "),b.Xb(7,"span"),b.Mc(8),b.Wb(),b.Wb(),b.Wb(),b.Kc(9,_e,10,12,"ng-template",6),b.Xb(10,"mat-action-row"),b.Xb(11,"button",7),b.ec("click",(function(){b.Bc(e);const a=t.$implicit;return b.ic(2).maybeDeleteSeason(a)})),b.Mc(12,"Delete"),b.Wb(),b.Wb(),b.Wb()}if(2&e){const e=t.$implicit,a=b.ic(2);b.qc("expanded",b.kc(1,3,a.activeSeason$)===e.number)("ngClass","season-"+e.number+"-panel"),b.Eb(8),b.Nc(e.number)}}function Le(e,t){1&e&&(b.Xb(0,"no-results-message"),b.Xb(1,"span",13),b.Mc(2,"Nothing to Display."),b.Wb(),b.Xb(3,"span",14),b.Mc(4,"This series does not have any seasons yet."),b.Wb(),b.Wb())}function Ve(e,t){if(1&e){const e=b.Yb();b.Vb(0),b.Xb(1,"div",1),b.Xb(2,"button",2),b.ec("click",(function(){return b.Bc(e),b.ic().addSeason()})),b.jc(3,"async"),b.Mc(4,"Add Season"),b.Wb(),b.Wb(),b.Xb(5,"mat-accordion"),b.Kc(6,Ne,13,5,"mat-expansion-panel",3),b.Wb(),b.Kc(7,Le,5,0,"no-results-message",0),b.Ub()}if(2&e){const e=t.ngIf,a=b.ic();b.Eb(2),b.qc("disabled",b.kc(3,4,a.loading$)),b.Eb(4),b.qc("ngForOf",e)("ngForTrackBy",a.trackByFn),b.Eb(1),b.qc("ngIf",!e.length)}}let Fe=(()=>{class e{constructor(e,t,a,i,n){this.store=e,this.modal=t,this.toast=a,this.route=i,this.el=n,this.activeSeason$=new l.a(1)}ngOnInit(){this.activeSeason$.next(+this.route.snapshot.params.seasonNumber||1)}ngAfterViewInit(){setTimeout(()=>{var e;this.activeSeason$.value>1&&(null===(e=this.el.nativeElement.querySelector(`.season-${this.activeSeason$.value}-panel`))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"start",inline:"start"}))})}addSeason(){this.store.dispatch(new s.i).subscribe(()=>{this.toast.open(x.a.SEASON_CREATE_SUCCESS)})}maybeDeleteSeason(e){this.modal.open(R.a,{title:"Delete Season",body:"Are you sure you want to delete this season?",bodyBold:"This will also delete all episodes attached to this season.",ok:"Delete"}).afterClosed().subscribe(t=>{t&&this.store.dispatch(new s.l(e)).subscribe(()=>{this.toast.open(x.a.SEASON_DELETE_SUCCESS)})})}trackByFn(e,t){return t.id}}return e.\u0275fac=function(t){return new(t||e)(b.Rb(o.g),b.Rb(T.a),b.Rb(S.b),b.Rb(n.a),b.Rb(b.m))},e.\u0275cmp=b.Lb({type:e,selectors:[["seasons-panel"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"header"],["type","button","mat-raised-button","","color","accent",3,"disabled","click"],["class","mat-elevation-z0",3,"expanded","ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mat-elevation-z0",3,"expanded","ngClass"],["trans",""],["matExpansionPanelContent",""],["type","button","mat-button","","trans","",3,"click"],["animationDuration","0ms","color","accent"],[3,"label"],[3,"season"],["type","cast",3,"mediaItem"],["type","crew",3,"mediaItem"],["primary-text","","trans",""],["secondary-text","","trans",""]],template:function(e,t){1&e&&(b.Kc(0,Ve,8,6,"ng-container",0),b.jc(1,"async")),2&e&&b.qc("ngIf",b.kc(1,1,t.seasons$))},directives:[i.t,E.b,P.a,i.s,P.c,i.q,P.f,P.g,d.a,P.e,P.d,j.c,j.a,Ke,xe,ae.a],pipes:[i.b,M.a],styles:["seasons-panel{display:block}seasons-panel .header{margin-bottom:20px}seasons-panel .mat-expansion-panel{border:1px solid var(--be-divider-default);border-radius:4px;margin-bottom:10px}seasons-panel .mat-expansion-panel .mat-expansion-panel-header-title{font-weight:500;font-size:1.5rem}seasons-panel .mat-tab-group .mat-tab-body-wrapper{padding:15px}seasons-panel .mat-column-name media-image{margin-right:15px}seasons-panel .mat-column-name media-image img{width:50px;height:35px;flex-shrink:0;border-radius:4px}seasons-panel .mat-column-edit{max-width:100px;color:var(--be-secondary-text)}"],encapsulation:2,changeDetection:0}),Object(c.b)([Object(o.d)(r.a.seasons)],e.prototype,"seasons$",void 0),Object(c.b)([Object(o.d)(r.a.loading)],e.prototype,"loading$",void 0),e})();var Ae=a("35We"),Ue=a("vxfF");function Be(e,t){if(1&e){const e=b.Yb();b.Xb(0,"div",4),b.ec("cdkDropListDropped",(function(){return b.Bc(e),b.ic().dropListDropped()})),b.Xb(1,"media-image",7),b.ec("cdkDragMoved",(function(t){return b.Bc(e),b.ic().dragMoved(t)})),b.Xb(2,"button",8),b.ec("click",(function(){b.Bc(e);const a=t.$implicit;return b.ic().deleteImage(a)})),b.Sb(3,"mat-icon",9),b.Wb(),b.Wb(),b.Wb()}if(2&e){const e=t.$implicit,a=b.ic();b.qc("cdkDropListEnterPredicate",a.dropListEnterPredicate),b.Eb(1),b.qc("src",e.url)}}let ze=(()=>{class e{constructor(e,t,a,i){this.images=e,this.store=t,this.toast=a,this.viewportRuler=i,this.dropListEnterPredicate=(e,t)=>{if(t===this.placeholder)return!0;if(t!==this.activeContainer)return!1;const a=this.placeholder.element.nativeElement,i=e.dropContainer.element.nativeElement,n=t.element.nativeElement,c=He(n.parentElement.children,this.source?a:i),o=He(n.parentElement.children,n);return this.source||(this.sourceIndex=c,this.source=e.dropContainer,a.style.width=i.clientWidth+"px",a.style.height=i.clientHeight+"px",i.parentElement.removeChild(i)),this.targetIndex=o,this.target=t,a.style.display="",n.parentElement.insertBefore(a,o>c?n.nextSibling:n),this.placeholder._dropListRef.enter(e._dragRef,e.element.nativeElement.offsetLeft,e.element.nativeElement.offsetTop),!1}}uploadImage(){Object(g.a)({types:[h.a.image]}).then(e=>{const t={modelId:this.store.selectSnapshot(r.a.title).id};this.images.create(e[0],t).subscribe(e=>{this.store.dispatch(new s.b(e.image)).subscribe(()=>{this.toast.open(x.a.IMAGE_CREATE_SUCCESS)})})})}deleteImage(e){this.store.dispatch(new s.k(e)).subscribe(()=>{this.toast.open(x.a.IMAGE_DELETE_SUCCESS)})}dragMoved(e){const t=this.getPointerPositionOnPage(e.event);this.listGroup._items.forEach(e=>{(function(e,t,a){const{top:i,bottom:n,left:c,right:o}=e.element.nativeElement.getBoundingClientRect();return a>=i&&a<=n&&t>=c&&t<=o})(e,t.x,t.y)&&(this.activeContainer=e)})}dropListDropped(){if(!this.target)return;const e=this.placeholder.element.nativeElement,t=e.parentElement;e.style.display="none",t.removeChild(e),t.appendChild(e),t.insertBefore(this.source.element.nativeElement,t.children[this.sourceIndex]),this.target=null,this.source=null,this.sourceIndex!==this.targetIndex&&this.store.dispatch(new s.f(this.sourceIndex,this.targetIndex))}getPointerPositionOnPage(e){const t=function(e){return e.type.startsWith("touch")}(e)?e.touches[0]||e.changedTouches[0]:e,a=this.viewportRuler.getViewportScrollPosition();return{x:t.pageX-a.left,y:t.pageY-a.top}}}return e.\u0275fac=function(t){return new(t||e)(b.Rb(Ae.a),b.Rb(o.g),b.Rb(S.b),b.Rb(Ue.e))},e.\u0275cmp=b.Lb({type:e,selectors:[["images-panel"]],viewQuery:function(e,t){var a;1&e&&(b.Rc(te.e,!0),b.Rc(te.d,!0)),2&e&&(b.xc(a=b.fc())&&(t.listGroup=a.first),b.xc(a=b.fc())&&(t.placeholder=a.first))},features:[b.Db([m.a])],decls:9,vars:4,consts:[["mat-raised-button","","color","accent",3,"click"],["svgIcon","add"],["trans",""],["cdkDropListGroup",""],["cdkDropList","",3,"cdkDropListEnterPredicate","cdkDropListDropped"],[1,"images-grid"],["cdkDropList","",3,"cdkDropListEnterPredicate","cdkDropListDropped",4,"ngFor","ngForOf"],["cdkDrag","","size","medium","mode","landscape",1,"images-panel-media-image",3,"src","cdkDragMoved"],["mat-mini-fab","","color","warn",3,"click"],["svgIcon","delete"]],template:function(e,t){1&e&&(b.Xb(0,"button",0),b.ec("click",(function(){return t.uploadImage()})),b.Sb(1,"mat-icon",1),b.Xb(2,"span",2),b.Mc(3,"Upload Image"),b.Wb(),b.Wb(),b.Xb(4,"div",3),b.Xb(5,"div",4),b.ec("cdkDropListDropped",(function(){return t.dropListDropped()})),b.Wb(),b.Xb(6,"div",5),b.Kc(7,Be,4,2,"div",6),b.jc(8,"async"),b.Wb(),b.Wb()),2&e&&(b.Eb(5),b.qc("cdkDropListEnterPredicate",t.dropListEnterPredicate),b.Eb(2),b.qc("ngForOf",b.kc(8,2,t.images$)))},directives:[E.b,k.a,d.a,te.e,te.d,i.s,C.a,te.a],pipes:[i.b],styles:[".mat-raised-button[_ngcontent-%COMP%]{display:block;margin-bottom:25px}.images-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);grid-auto-rows:1fr;grid-gap:15px;overflow:hidden}media-image[_ngcontent-%COMP%]{display:block;box-shadow:0 3px 3px -2px rgba(0,0,0,.2),0 3px 4px 0 rgba(0,0,0,.14),0 1px 8px 0 rgba(0,0,0,.12);border-radius:4px;overflow:hidden;position:relative;cursor:move;transition:box-shadow .2s cubic-bezier(0,0,.2,1)}media-image[_ngcontent-%COMP%]:active{box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12);opacity:.6}.mat-mini-fab[_ngcontent-%COMP%]{position:absolute;bottom:8px;right:8px}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.3}.cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}"],changeDetection:0}),Object(c.b)([Object(o.d)(r.a.images)],e.prototype,"images$",void 0),e})();function He(e,t){return Array.prototype.indexOf.call(e,t)}var Ge=a("SRuq"),Je=a("WAq7"),Ye=a("CZpq"),Qe=a("A5z7");function Ze(e,t){if(1&e){const e=b.Yb();b.Xb(0,"form",9),b.ec("ngSubmit",(function(){b.Bc(e);const t=b.ic();return t.selectTagsFromString(t.formControl.value)})),b.Xb(1,"div",10),b.Sb(2,"input",11),b.Xb(3,"button",12),b.Mc(4,"Add"),b.Wb(),b.Wb(),b.Wb()}if(2&e){const e=b.ic(),t=b.yc(8);b.Eb(2),b.qc("matAutocomplete",t)("formControl",e.formControl)}}const et=function(e){return{tagName:e}};function tt(e,t){if(1&e&&(b.Xb(0,"p",13),b.Mc(1,"Separate :tagName with comma."),b.Wb()),2&e){const e=b.ic();b.qc("transValues",b.uc(1,et,e.pluralName))}}function at(e,t){if(1&e){const e=b.Yb();b.Xb(0,"mat-chip",14),b.ec("removed",(function(){b.Bc(e);const a=t.$implicit;return b.ic().deselectTag(a)})),b.Xb(1,"span"),b.Mc(2),b.Wb(),b.Sb(3,"mat-icon",15),b.Wb()}if(2&e){const e=t.$implicit,a=b.ic();b.qc("removable",!a.readonly),b.Eb(2),b.Nc(e)}}function it(e,t){if(1&e){const e=b.Yb();b.Xb(0,"div",20),b.ec("click",(function(){b.Bc(e);const a=t.$implicit;return b.ic(2).selectTags([a.name])})),b.Mc(1),b.Wb()}if(2&e){const e=t.$implicit;b.Eb(1),b.Nc(e.display_name)}}function nt(e,t){if(1&e&&(b.Xb(0,"div",16),b.Xb(1,"p",17),b.Mc(2,"Choose from existing :tagName:"),b.Wb(),b.Xb(3,"div",18),b.Kc(4,it,2,1,"div",19),b.jc(5,"async"),b.Wb(),b.Wb()),2&e){const e=b.ic();b.Eb(1),b.qc("transValues",b.uc(4,et,e.pluralName)),b.Eb(3),b.qc("ngForOf",b.kc(5,2,e.existingTags$))}}function ct(e,t){if(1&e&&(b.Xb(0,"mat-option",21),b.Mc(1),b.Wb()),2&e){const e=t.$implicit;b.qc("value",e.name),b.Eb(1),b.Nc(e.display_name)}}let ot=(()=>{class e{constructor(e){this.tagService=e,this.readonly=!1,this.pluralName="tags",this.formControl=new u.i,this.selectedTags$=new l.a([]),this.existingTags$=new l.a([]),this.suggestedTags$=new l.a([])}ngOnInit(){this.tagService.index({perPage:15,type:this.tagType}).subscribe(e=>{this.existingTags$.next(e.pagination.data.filter(e=>"status"!==e.type))}),this.formControl.valueChanges.subscribe(e=>{const t=e?this.existingTags$.value.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())):[];this.suggestedTags$.next(t)})}writeValue(e){this.selectTags(e,!1)}registerOnChange(e){this.propagateChange=e}registerOnTouched(){}selectTags(e,t=!0){const a=(e||[]).map(e=>e.trim()).filter(e=>!this.selectedTags$.value.includes(e));a.length&&this.selectedTags$.next([...this.selectedTags$.value,...a]),this.formControl.reset(),t&&this.propagateChange(this.selectedTags$.value)}deselectTag(e){const t=this.selectedTags$.value.slice();t.splice(t.indexOf(e),1),this.selectedTags$.next(t),this.propagateChange(this.selectedTags$.value)}selectTagsFromString(e){const t=e.split(",").map(e=>Object(Je.a)(e));this.selectTags(t)}}return e.\u0275fac=function(t){return new(t||e)(b.Rb(Ye.a))},e.\u0275cmp=b.Lb({type:e,selectors:[["tags-manager"]],inputs:{readonly:"readonly",tagType:"tagType",pluralName:"pluralName"},features:[b.Db([{provide:u.s,useExisting:e,multi:!0}])],decls:11,vars:10,consts:[["class","input-container","ngNativeValidate","",3,"ngSubmit",4,"ngIf"],["class","main-info","trans","",3,"transValues",4,"ngIf"],[1,"selected-tags"],[3,"selectable"],[3,"removable","removed",4,"ngFor","ngForOf"],["class","existing-tags",4,"ngIf"],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["ngNativeValidate","",1,"input-container",3,"ngSubmit"],[1,"input-with-action"],["type","text","required","",1,"tags-string-input",3,"matAutocomplete","formControl"],["type","submit","mat-flat-button","","color","accent","trans","",1,"add-tags-button"],["trans","",1,"main-info",3,"transValues"],[3,"removable","removed"],["svgIcon","cancel","matChipRemove",""],[1,"existing-tags"],["trans","",3,"transValues"],[1,"existing-tags-list"],["class","existing-tag-name",3,"click",4,"ngFor","ngForOf"],[1,"existing-tag-name",3,"click"],[3,"value"]],template:function(e,t){1&e&&(b.Kc(0,Ze,5,2,"form",0),b.Kc(1,tt,2,3,"p",1),b.Xb(2,"div",2),b.Xb(3,"mat-chip-list",3),b.Kc(4,at,4,2,"mat-chip",4),b.jc(5,"async"),b.Wb(),b.Wb(),b.Kc(6,nt,6,6,"div",5),b.Xb(7,"mat-autocomplete",6,7),b.ec("optionSelected",(function(e){return t.selectTags([e.option.value])})),b.Kc(9,ct,2,2,"mat-option",8),b.jc(10,"async"),b.Wb()),2&e&&(b.qc("ngIf",!t.readonly),b.Eb(1),b.qc("ngIf",!t.readonly),b.Eb(2),b.qc("selectable",!1),b.Eb(1),b.qc("ngForOf",b.kc(5,6,t.selectedTags$)),b.Eb(2),b.qc("ngIf",!t.readonly),b.Eb(3),b.qc("ngForOf",b.kc(10,8,t.suggestedTags$)))},directives:[i.t,Qe.c,i.s,F.a,u.v,u.w,F.c,u.d,u.F,u.u,u.j,E.b,d.a,Qe.a,k.a,Qe.d,A.n],pipes:[i.b],styles:["[_nghost-%COMP%]{display:block}.selected-tag[_ngcontent-%COMP%]{margin:0 10px 10px 0;display:inline-block}.main-info[_ngcontent-%COMP%]{margin-top:5px;font-size:1.3rem}.existing-tags[_ngcontent-%COMP%]{margin-top:25px}.existing-tags[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:5px;font-size:1.3rem;color:var(--be-secondary-text)}.existing-tags-list[_ngcontent-%COMP%]{border:1px solid var(--be-divider-default);padding:8px;height:78px;overflow:auto}.existing-tag-name[_ngcontent-%COMP%]{display:inline-block;margin-right:6px;color:var(--be-link);text-decoration:underline;font-size:1.2rem;cursor:pointer}"],changeDetection:0}),e})();const st=function(e){return{tagName:e}};let rt=(()=>{class e{constructor(e,t){this.dialogRef=e,this.data=t,this.selectedTagsControl=new u.i,this.pluralName=this.data.pluralName||"tags"}close(){this.dialogRef.close()}confirm(){this.dialogRef.close(this.selectedTagsControl.value)}noTagsSelected(){var e;return!(null===(e=this.selectedTagsControl.value)||void 0===e?void 0:e.length)}}return e.\u0275fac=function(t){return new(t||e)(b.Rb($.h),b.Rb($.a))},e.\u0275cmp=b.Lb({type:e,selectors:[["tag-manager-modal"]],decls:12,vars:10,consts:[[1,"modal-header"],["mat-dialog-title","","trans","",3,"transValues"],["type","button","mat-icon-button","","tabindex","-1",1,"close-button",3,"click"],["svgIcon","close"],[3,"tagType","pluralName","formControl"],["type","button","mat-button","","trans","",1,"cancel-button",3,"click"],["type","button","mat-raised-button","","color","accent","trans","",1,"submit-button",3,"disabled","transValues","click"]],template:function(e,t){1&e&&(b.Xb(0,"div",0),b.Xb(1,"h2",1),b.Mc(2,"Select :tagName"),b.Wb(),b.Xb(3,"button",2),b.ec("click",(function(){return t.close()})),b.Sb(4,"mat-icon",3),b.Wb(),b.Wb(),b.Xb(5,"mat-dialog-content"),b.Sb(6,"tags-manager",4),b.Wb(),b.Xb(7,"mat-dialog-actions"),b.Xb(8,"button",5),b.ec("click",(function(){return t.close()})),b.Mc(9,"Cancel"),b.Wb(),b.Xb(10,"button",6),b.ec("click",(function(){return t.confirm()})),b.Mc(11,"Merge :tagName"),b.Wb(),b.Wb()),2&e&&(b.Eb(1),b.qc("transValues",b.uc(6,st,t.pluralName)),b.Eb(5),b.qc("tagType",t.data.tagType)("pluralName",t.pluralName)("formControl",t.selectedTagsControl),b.Eb(4),b.qc("disabled",t.noTagsSelected())("transValues",b.uc(8,st,t.pluralName)))},directives:[$.i,d.a,E.b,k.a,$.f,ot,u.u,u.j,$.c],styles:["[_nghost-%COMP%]{display:block;width:400px;max-width:100%}.mat-dialog-title[_ngcontent-%COMP%], .submit-button[_ngcontent-%COMP%]{text-transform:capitalize}"],changeDetection:0}),e})();function lt(e,t){1&e&&(b.Xb(0,"mat-header-cell",16),b.Mc(1,"Name"),b.Wb())}function bt(e,t){if(1&e&&(b.Xb(0,"mat-cell"),b.Mc(1),b.Wb()),2&e){const e=t.$implicit;b.Eb(1),b.Oc(" ",e.name," ")}}function dt(e,t){1&e&&(b.Xb(0,"mat-header-cell",16),b.Mc(1,"Display Name"),b.Wb())}function pt(e,t){if(1&e&&(b.Xb(0,"mat-cell"),b.Mc(1),b.Wb()),2&e){const e=t.$implicit;b.Eb(1),b.Oc(" ",e.display_name||"-"," ")}}function ut(e,t){1&e&&b.Sb(0,"mat-header-cell")}function mt(e,t){if(1&e){const e=b.Yb();b.Xb(0,"mat-cell"),b.Xb(1,"button",17),b.ec("click",(function(){b.Bc(e);const a=t.$implicit;return b.ic().detachTag(a)})),b.Sb(2,"mat-icon",18),b.Wb(),b.Wb()}}function gt(e,t){1&e&&b.Sb(0,"mat-header-row")}function ht(e,t){1&e&&b.Sb(0,"mat-row")}function ft(e,t){if(1&e&&(b.Xb(0,"no-results-message"),b.Xb(1,"span",19),b.Mc(2,"Nothing to Display."),b.Wb(),b.Xb(3,"span",20),b.Mc(4),b.Wb(),b.Wb()),2&e){const e=b.ic();b.Eb(4),b.Oc("Attach new ",e.displayType||e.type," from above.")}}const vt=function(){return["name","display_name","edit"]};let yt=(()=>{class e{constructor(e,t,a){this.store=e,this.modal=t,this.toast=a,this.dataSource=new ee.p}ngOnInit(){this.dataSource.sort=this.matSort,this.getTagObservable().subscribe(e=>{this.dataSource.data=e||[]})}openTagManagerModal(){this.modal.open(rt,{tagType:this.type,pluralName:"production_country"===this.type?"countries":this.type+"s"}).beforeClosed().subscribe(e=>{e&&e.length&&this.store.dispatch(new s.d(e,this.type))})}detachTag(e){this.store.dispatch(new s.n(e)).subscribe(()=>{this.toast.open(x.a.TAG_DETACH_SUCCESS)})}applyFilter(e){this.dataSource.filter=e}getTagObservable(){return this.store.select("keyword"===this.type?r.a.keywords:"genre"===this.type?r.a.genres:r.a.countries)}}return e.\u0275fac=function(t){return new(t||e)(b.Rb(o.g),b.Rb(T.a),b.Rb(S.b))},e.\u0275cmp=b.Lb({type:e,selectors:[["tags-panel"]],viewQuery:function(e,t){var a;1&e&&b.Ic(Z.a,!0),2&e&&b.xc(a=b.fc())&&(t.matSort=a.first)},inputs:{type:"type",displayType:"displayType"},decls:22,vars:12,consts:[[1,"table-header"],[1,"button-container"],["mat-raised-button","","color","accent",3,"click"],[1,"input-container"],["type","text","placeholder","Search...","trans-placeholder","",3,"keyup"],["svgIcon","search"],["matSort","",3,"dataSource"],["matColumnDef","name"],["mat-sort-header","","trans","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","display_name"],["matColumnDef","edit"],[4,"matHeaderCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[4,"ngIf"],["mat-sort-header","","trans",""],["mat-icon-button","",3,"click"],["svgIcon","close"],["primary-text","","trans",""],["secondary-text","","trans",""]],template:function(e,t){1&e&&(b.Xb(0,"div",0),b.Xb(1,"div",1),b.Xb(2,"button",2),b.ec("click",(function(){return t.openTagManagerModal()})),b.Mc(3),b.jc(4,"trans"),b.jc(5,"trans"),b.Wb(),b.Wb(),b.Xb(6,"div",3),b.Xb(7,"input",4),b.ec("keyup",(function(e){return t.applyFilter(e.target.value)})),b.Wb(),b.Sb(8,"mat-icon",5),b.Wb(),b.Wb(),b.Xb(9,"mat-table",6),b.Vb(10,7),b.Kc(11,lt,2,0,"mat-header-cell",8),b.Kc(12,bt,2,1,"mat-cell",9),b.Ub(),b.Vb(13,10),b.Kc(14,dt,2,0,"mat-header-cell",8),b.Kc(15,pt,2,1,"mat-cell",9),b.Ub(),b.Vb(16,11),b.Kc(17,ut,1,0,"mat-header-cell",12),b.Kc(18,mt,3,0,"mat-cell",9),b.Ub(),b.Kc(19,gt,1,0,"mat-header-row",13),b.Kc(20,ht,1,0,"mat-row",14),b.Wb(),b.Kc(21,ft,5,1,"no-results-message",15)),2&e&&(b.Eb(3),b.Pc(" ",b.kc(4,6,"Add")," ",b.kc(5,8,t.displayType||t.type+"s")," "),b.Eb(6),b.qc("dataSource",t.dataSource),b.Eb(10),b.qc("matHeaderRowDef",b.tc(10,vt)),b.Eb(1),b.qc("matRowDefColumns",b.tc(11,vt)),b.Eb(1),b.qc("ngIf",!(null!=t.dataSource.data&&t.dataSource.data.length)))},directives:[E.b,d.a,k.a,ee.o,Z.a,ee.c,ee.i,ee.b,ee.k,ee.n,i.t,ee.h,Z.b,ee.a,ee.j,ee.m,ae.a],pipes:[M.a],styles:[""],encapsulation:2,changeDetection:0}),e})();var xt=a("HSW/"),Wt=a("Xd/8"),Xt=a("re4b"),St=a("Xmgp"),Ct=a("twBr"),Et=a("MZC4");function wt(e,t){if(1&e){const e=b.Yb();b.Xb(0,"button",14),b.ec("click",(function(){return b.Bc(e),b.ic(2).openCrupdateReviewModal()})),b.Mc(1,"Add"),b.Wb()}}function kt(e,t){if(1&e){const e=b.Yb();b.Xb(0,"button",15),b.ec("click",(function(){return b.Bc(e),b.ic(2).maybeDeleteSelectedReviews()})),b.jc(1,"trans"),b.Sb(2,"mat-icon",16),b.Wb()}2&e&&b.qc("matTooltip",b.kc(1,1,"Delete selected"))}function It(e,t){1&e&&(b.Xb(0,"mat-header-cell",17),b.Mc(1,"Review"),b.Wb())}function Mt(e,t){if(1&e&&(b.Xb(0,"mat-cell"),b.Mc(1),b.jc(2,"slice"),b.Wb()),2&e){const e=t.$implicit;b.Eb(1),b.Oc(" ",b.mc(2,1,e.body,0,200)," ")}}function qt(e,t){1&e&&(b.Xb(0,"mat-header-cell",18),b.Mc(1,"Author"),b.Wb())}function Dt(e,t){if(1&e&&(b.Xb(0,"mat-cell"),b.Mc(1),b.Wb()),2&e){const e=t.$implicit;b.Eb(1),b.Oc(" ",e.author?e.author:"-"," ")}}function Ot(e,t){1&e&&(b.Xb(0,"mat-header-cell",18),b.Mc(1,"Score"),b.Wb())}function Rt(e,t){if(1&e&&(b.Xb(0,"mat-cell"),b.Mc(1),b.Wb()),2&e){const e=t.$implicit;b.Eb(1),b.Oc(" ",e.score?e.score:"-"," ")}}function Tt(e,t){1&e&&(b.Xb(0,"mat-header-cell",18),b.Mc(1,"type"),b.Wb())}function Pt(e,t){if(1&e&&(b.Xb(0,"mat-cell"),b.Mc(1),b.Wb()),2&e){const e=t.$implicit;b.Eb(1),b.Oc(" ",e.type," ")}}function jt(e,t){1&e&&b.Sb(0,"mat-header-cell")}function $t(e,t){if(1&e){const e=b.Yb();b.Xb(0,"button",20),b.ec("click",(function(){b.Bc(e);const t=b.ic().$implicit;return b.ic(2).openCrupdateReviewModal(t)})),b.Sb(1,"mat-icon",21),b.Wb()}}function Kt(e,t){if(1&e&&(b.Xb(0,"mat-cell"),b.Kc(1,$t,2,0,"button",19),b.Wb()),2&e){const e=b.ic(2);b.Eb(1),b.qc("ngIf",e.currentUser.hasPermission("reviews.update"))}}function _t(e,t){if(1&e&&(b.Xb(0,"data-table",2),b.Kc(1,wt,2,0,"button",3),b.Kc(2,kt,3,3,"button",4),b.Vb(3,5),b.Kc(4,It,2,0,"mat-header-cell",6),b.Kc(5,Mt,3,5,"mat-cell",7),b.Ub(),b.Vb(6,8),b.Kc(7,qt,2,0,"mat-header-cell",9),b.Kc(8,Dt,2,1,"mat-cell",7),b.Ub(),b.Vb(9,10),b.Kc(10,Ot,2,0,"mat-header-cell",9),b.Kc(11,Rt,2,1,"mat-cell",7),b.Ub(),b.Vb(12,11),b.Kc(13,Tt,2,0,"mat-header-cell",9),b.Kc(14,Pt,2,1,"mat-cell",7),b.Ub(),b.Vb(15,12),b.Kc(16,jt,1,0,"mat-header-cell",13),b.Kc(17,Kt,2,1,"mat-cell",7),b.Ub(),b.Wb()),2&e){const e=b.ic();b.qc("dataSource",e.dataSource),b.Eb(1),b.qc("ngIf",e.currentUser.hasPermission("reviews.create")),b.Eb(1),b.qc("ngIf",e.currentUser.hasPermission("reviews.delete"))}}let Nt=(()=>{class e{constructor(e,t,a,i,n,c){this.store=e,this.modal=t,this.toast=a,this.reviews=i,this.paginator=n,this.currentUser=c,n.dontUpdateQueryParams=!0}ngOnInit(){const e=this.store.selectSnapshot(r.a.title);this.dataSource=new Wt.a({uri:"reviews",dataPaginator:this.paginator,matSort:this.matSort,staticParams:{compact:!0,titleId:e.id}})}ngOnDestroy(){this.paginator.destroy()}openCrupdateReviewModal(e){const t=this.store.selectSnapshot(r.a.title).id;this.modal.open(xt.a,{review:e,mediaId:t},{panelClass:"crupdate-review-modal-container"}).beforeClosed().subscribe(e=>{e&&this.dataSource.reset()})}maybeDeleteSelectedReviews(){this.modal.show(R.a,{title:"Delete Reviews",body:"Are you sure you want to delete selected reviews?",ok:"Delete"}).beforeClosed().subscribe(e=>{if(!e)return;const t=this.dataSource.getSelectedItems();this.reviews.delete(t).subscribe(()=>{this.dataSource.reset()})})}}return e.\u0275fac=function(t){return new(t||e)(b.Rb(o.g),b.Rb(T.a),b.Rb(S.b),b.Rb(St.a),b.Rb(Xt.a),b.Rb(Ct.a))},e.\u0275cmp=b.Lb({type:e,selectors:[["reviews-panel"]],viewQuery:function(e,t){var a;1&e&&b.Ic(Z.a,!0),2&e&&b.xc(a=b.fc())&&(t.matSort=a.first)},features:[b.Db([Xt.a])],decls:2,vars:1,consts:[["matSort",""],["itemsName","reviews",3,"dataSource",4,"ngIf"],["itemsName","reviews",3,"dataSource"],["mat-raised-button","","color","accent","headerActions","","trans","",3,"click",4,"ngIf"],["mat-icon-button","","headerSelectedActions","",3,"matTooltip","click",4,"ngIf"],["matColumnDef","review"],["trans","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","author"],["mat-sort-header","","trans","",4,"matHeaderCellDef"],["matColumnDef","score"],["matColumnDef","type"],["matColumnDef","edit"],[4,"matHeaderCellDef"],["mat-raised-button","","color","accent","headerActions","","trans","",3,"click"],["mat-icon-button","","headerSelectedActions","",3,"matTooltip","click"],["svgIcon","delete"],["trans",""],["mat-sort-header","","trans",""],["mat-icon-button","",3,"click",4,"ngIf"],["mat-icon-button","",3,"click"],["svgIcon","edit"]],template:function(e,t){1&e&&(b.Xb(0,"div",0),b.Kc(1,_t,18,3,"data-table",1),b.Wb()),2&e&&(b.Eb(1),b.qc("ngIf",t.dataSource))},directives:[Z.a,i.t,Et.a,ee.c,ee.i,ee.b,E.b,d.a,w.a,k.a,ee.h,ee.a,Z.b],pipes:[M.a,i.E],styles:["reviews-panel{display:block}reviews-panel.material-panel{padding:0}reviews-panel .admin-table-panel{margin:0;box-shadow:none}reviews-panel .mat-column-type{text-transform:capitalize}reviews-panel .mat-column-author,reviews-panel .mat-column-score,reviews-panel .mat-column-type{max-width:120px}reviews-panel .mat-column-review{margin-right:30px;word-break:break-word}"],encapsulation:2,changeDetection:0}),e})();function Lt(e,t){1&e&&b.Sb(0,"primary-facts-panel",15)}function Vt(e,t){1&e&&b.Sb(0,"seasons-panel",15)}function Ft(e,t){1&e&&b.Sb(0,"images-panel",15)}function At(e,t){if(1&e&&b.Sb(0,"video-index",16),2&e){const e=b.ic(2);b.qc("title",e.title)}}function Ut(e,t){if(1&e&&b.Sb(0,"credits-panel",17),2&e){const e=b.ic(2);b.qc("mediaItem",e.title)}}function Bt(e,t){if(1&e&&b.Sb(0,"credits-panel",18),2&e){const e=b.ic(2);b.qc("mediaItem",e.title)}}function zt(e,t){1&e&&b.Sb(0,"tags-panel",19)}function Ht(e,t){1&e&&b.Sb(0,"tags-panel",20)}function Gt(e,t){1&e&&b.Sb(0,"tags-panel",21)}function Jt(e,t){1&e&&b.Sb(0,"reviews-panel",15)}function Yt(e,t){1&e&&(b.Xb(0,"p",22),b.Mc(1,'Save from "Primary Facts" panel in order to enable other menu items.'),b.Wb())}function Qt(e,t){if(1&e){const e=b.Yb();b.Vb(0),b.Kc(1,Lt,1,0,"primary-facts-panel",1),b.Kc(2,Vt,1,0,"seasons-panel",1),b.Kc(3,Ft,1,0,"images-panel",1),b.Kc(4,At,1,1,"video-index",2),b.Kc(5,Ut,1,1,"credits-panel",3),b.Kc(6,Bt,1,1,"credits-panel",4),b.Kc(7,zt,1,0,"tags-panel",5),b.Kc(8,Ht,1,0,"tags-panel",6),b.Kc(9,Gt,1,0,"tags-panel",7),b.Kc(10,Jt,1,0,"reviews-panel",1),b.Xb(11,"aside",8),b.Xb(12,"div",9),b.Mc(13,"Edit"),b.Wb(),b.Xb(14,"div",10),b.Xb(15,"button",11),b.ec("click",(function(){return b.Bc(e),b.ic().openPanel("primaryFacts")})),b.Mc(16,"Primary Facts"),b.Wb(),b.Xb(17,"button",12),b.ec("click",(function(){return b.Bc(e),b.ic().openPanel("seasons")})),b.Mc(18,"Seasons"),b.Wb(),b.Xb(19,"button",12),b.ec("click",(function(){return b.Bc(e),b.ic().openPanel("images")})),b.Mc(20,"Images"),b.Wb(),b.Xb(21,"button",12),b.ec("click",(function(){return b.Bc(e),b.ic().openPanel("videos")})),b.Mc(22,"Videos"),b.Wb(),b.Xb(23,"button",12),b.ec("click",(function(){return b.Bc(e),b.ic().openPanel("cast")})),b.Mc(24,"Cast"),b.Wb(),b.Xb(25,"button",12),b.ec("click",(function(){return b.Bc(e),b.ic().openPanel("crew")})),b.Mc(26,"Crew"),b.Wb(),b.Xb(27,"button",12),b.ec("click",(function(){return b.Bc(e),b.ic().openPanel("genres")})),b.Mc(28,"Genres"),b.Wb(),b.Xb(29,"button",12),b.ec("click",(function(){return b.Bc(e),b.ic().openPanel("keywords")})),b.Mc(30,"Keywords"),b.Wb(),b.Xb(31,"button",12),b.ec("click",(function(){return b.Bc(e),b.ic().openPanel("countries")})),b.Mc(32,"Countries"),b.Wb(),b.Xb(33,"button",12),b.ec("click",(function(){return b.Bc(e),b.ic().openPanel("reviews")})),b.Mc(34,"Reviews"),b.Wb(),b.Wb(),b.Kc(35,Yt,2,0,"p",13),b.Wb(),b.Sb(36,"loading-indicator",14),b.jc(37,"async"),b.Ub()}if(2&e){const e=t.ngIf,a=b.ic();b.Eb(1),b.qc("ngIf","primaryFacts"===e),b.Eb(1),b.qc("ngIf","seasons"===e),b.Eb(1),b.qc("ngIf","images"===e),b.Eb(1),b.qc("ngIf","videos"===e),b.Eb(1),b.qc("ngIf","cast"===e),b.Eb(1),b.qc("ngIf","crew"===e),b.Eb(1),b.qc("ngIf","keywords"===e),b.Eb(1),b.qc("ngIf","genres"===e),b.Eb(1),b.qc("ngIf","countries"===e),b.Eb(1),b.qc("ngIf","reviews"===e),b.Eb(5),b.Ib("active","primaryFacts"===e),b.Eb(2),b.Ib("active","seasons"===e),b.qc("disabled",!a.titleCreated()),b.Eb(2),b.Ib("active","images"===e),b.qc("disabled",!a.titleCreated()),b.Eb(2),b.Ib("active","videos"===e),b.qc("disabled",!a.titleCreated()),b.Eb(2),b.Ib("active","cast"===e),b.qc("disabled",!a.titleCreated()),b.Eb(2),b.Ib("active","crew"===e),b.qc("disabled",!a.titleCreated()),b.Eb(2),b.Ib("active","genres"===e),b.qc("disabled",!a.titleCreated()),b.Eb(2),b.Ib("active","keywords"===e),b.qc("disabled",!a.titleCreated()),b.Eb(2),b.Ib("active","countries"===e),b.qc("disabled",!a.titleCreated()),b.Eb(2),b.Ib("active","reviews"===e),b.qc("disabled",!a.titleCreated()),b.Eb(2),b.qc("ngIf",!a.titleCreated()),b.Eb(1),b.qc("isVisible",b.kc(37,41,a.loading$))}}let Zt=(()=>{class e{constructor(e,t,a){this.store=e,this.router=t,this.route=a,this.activePanel$=new l.a("primaryFacts")}ngOnInit(){this.route.data.subscribe(e=>{var t,a;this.store.dispatch(new s.o(null===(t=e.api)||void 0===t?void 0:t.title)),this.title=null===(a=e.api)||void 0===a?void 0:a.title}),this.route.queryParams.subscribe(e=>{this.activePanel$.next(e.active||"primaryFacts")}),this.route.snapshot.params.seasonNumber&&this.activePanel$.next("seasons")}ngOnDestroy(){this.store.dispatch(new s.s)}openPanel(e){this.router.navigate([],{queryParams:{active:e}})}titleCreated(){return!!this.store.selectSnapshot(r.a.title).id}}return e.\u0275fac=function(t){return new(t||e)(b.Rb(o.g),b.Rb(n.d),b.Rb(n.a))},e.\u0275cmp=b.Lb({type:e,selectors:[["crupdate-title"]],decls:2,vars:3,consts:[[4,"ngIf"],["class","material-panel crupdate-title-panel",4,"ngIf"],["class","material-panel crupdate-title-panel",3,"title",4,"ngIf"],["class","material-panel crupdate-title-panel","type","cast",3,"mediaItem",4,"ngIf"],["class","material-panel crupdate-title-panel","type","crew",3,"mediaItem",4,"ngIf"],["class","material-panel crupdate-title-panel","type","keyword",4,"ngIf"],["class","material-panel crupdate-title-panel","type","genre",4,"ngIf"],["class","material-panel crupdate-title-panel","type","production_country","displayType","country",4,"ngIf"],[1,"sidebar","material-panel"],["trans","",1,"header"],[1,"list"],["trans","",1,"list-item","no-style",3,"click"],["trans","",1,"list-item","no-style",3,"disabled","click"],["class","message","trans","",4,"ngIf"],[1,"overlay",3,"isVisible"],[1,"material-panel","crupdate-title-panel"],[1,"material-panel","crupdate-title-panel",3,"title"],["type","cast",1,"material-panel","crupdate-title-panel",3,"mediaItem"],["type","crew",1,"material-panel","crupdate-title-panel",3,"mediaItem"],["type","keyword",1,"material-panel","crupdate-title-panel"],["type","genre",1,"material-panel","crupdate-title-panel"],["type","production_country","displayType","country",1,"material-panel","crupdate-title-panel"],["trans","",1,"message"]],template:function(e,t){1&e&&(b.Kc(0,Qt,38,43,"ng-container",0),b.jc(1,"async")),2&e&&b.qc("ngIf",b.kc(1,1,t.activePanel$))},directives:[i.t,d.a,p.a,O,Fe,ze,Ge.a,xe,yt,Nt],pipes:[i.b],styles:[".be-dark-mode crupdate-title .sidebar .header{background-color:transparent;border-bottom:1px solid var(--be-divider-default)}crupdate-title{display:flex;align-items:flex-start;width:100%}crupdate-title .material-panel{flex:1 1 auto;padding:20px;min-height:412px}crupdate-title .material-panel .inline-container,crupdate-title .material-panel form>.input-container{margin-bottom:25px}crupdate-title video-index.material-panel{padding:0}crupdate-title data-table{border:none}crupdate-title .inline-container{display:flex}crupdate-title .inline-container .input-container{flex:1 1 auto}crupdate-title .inline-container .input-container.size-small{flex:1 1 30%}crupdate-title .inline-container .input-container:first-of-type{margin-right:15px}crupdate-title .sidebar{flex:0 0 260px;margin-left:30px;padding:0;overflow:hidden}crupdate-title .sidebar .header{background-color:var(--be-primary-default);color:var(--be-accent-contrast);padding:15px 20px;font-size:1.6rem;font-weight:500}crupdate-title .sidebar .list .list-item{display:block;width:100%;padding:10px 20px;white-space:nowrap;text-transform:capitalize}crupdate-title .sidebar .list .list-item:disabled{color:var(--be-hint-text);cursor:default}crupdate-title .sidebar .list .list-item.active{font-weight:500}crupdate-title .sidebar .list .list-item:not(:disabled):hover{cursor:pointer}crupdate-title .sidebar .message{margin:8px 20px;padding-top:8px;font-size:1.3rem;color:var(--be-secondary-text);border-top:1px solid var(--be-divider-lighter)}@media only screen and (max-width:768px){crupdate-title{display:block}crupdate-title primary-facts-panel.material-panel{border:none}crupdate-title primary-facts-panel.material-panel .poster-container{display:block}crupdate-title primary-facts-panel.material-panel .many-inputs{margin-left:0}crupdate-title primary-facts-panel.material-panel img{margin:0 auto 20px}crupdate-title .sidebar{margin:30px 20px 0}crupdate-title .inline-container{display:block}crupdate-title .inline-container .input-container:first-of-type{margin-bottom:20px}}.crupdate-title-panel .table-header,crupdate-episode-modal .table-header{display:flex;align-items:center;margin-bottom:15px}.crupdate-title-panel .table-header .mat-raised-button,crupdate-episode-modal .table-header .mat-raised-button{text-transform:capitalize}.crupdate-title-panel .table-header .input-container,crupdate-episode-modal .table-header .input-container{max-width:300px;margin-left:auto;position:relative}.crupdate-title-panel .table-header .input-container .mat-icon,crupdate-episode-modal .table-header .input-container .mat-icon{position:absolute;top:11px;right:8px}.crupdate-title-panel no-results-message,crupdate-episode-modal no-results-message{margin-top:50px;margin-bottom:50px}.crupdate-title-panel .mat-column-edit,crupdate-episode-modal .mat-column-edit{max-width:100px;color:var(--be-secondary-text)}"],encapsulation:2,changeDetection:0}),Object(c.b)([Object(o.d)(r.a.loading)],e.prototype,"loading$",void 0),e})();var ea=a("JIr8"),ta=a("5+tZ"),aa=a("LRne"),ia=a("EY2u");const na=[{path:"",component:Zt,resolve:{api:(()=>{class e{constructor(e,t,a){this.router=e,this.store=t,this.titles=a}resolve(e,t){return+e.params.titleId?this.titles.get(+e.params.titleId,{fullCredits:!0,keywords:!0,countries:!0,seasons:!0,skipUpdating:!0,allVideos:!0}).pipe(Object(ea.a)(()=>(this.router.navigate(this.fallbackUri(t)),ia.a)),Object(ta.a)(e=>e?Object(aa.a)(e):(this.router.navigate(this.fallbackUri(t)),ia.a))):Object(aa.a)(null)}fallbackUri(e){return e.url.includes("admin")?["/admin/titles"]:[e.url.replace("/edit","")]}}return e.\u0275fac=function(t){return new(t||e)(b.bc(n.d),b.bc(o.g),b.bc(X.a))},e.\u0275prov=b.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},data:{permissions:["titles.update"]}}];let ca=(()=>{class e{}return e.\u0275mod=b.Pb({type:e}),e.\u0275inj=b.Ob({factory:function(t){return new(t||e)},imports:[[n.h.forChild(na)],n.h]}),e})();var oa=a("6rvT"),sa=a("AsKK"),ra=a("Iysn"),la=a("ZFTr"),ba=a("k3xQ"),da=a("X3pI"),pa=a("NWPP");let ua=(()=>{class e{}return e.\u0275mod=b.Pb({type:e}),e.\u0275inj=b.Ob({factory:function(t){return new(t||e)},imports:[[i.c,ca,oa.a,sa.a,u.o,u.E,ra.a,la.a,ba.a,da.a,pa.a,E.c,k.b,ee.q,Z.c,w.b,$.g,j.g,I.c,P.b,te.f,F.b]]}),e})()}}]);
//# sourceMappingURL=3-es2015.d51be786f4c6bb58821e.js.map